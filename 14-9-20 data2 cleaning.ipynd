{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting pandas\n",
      "  Downloading pandas-1.1.2-cp37-cp37m-win_amd64.whl (9.4 MB)\n",
      "Requirement already satisfied: numpy>=1.15.4 in c:\\users\\shuei\\miniconda3\\envs\\tfgpu\\lib\\site-packages (from pandas) (1.19.1)\n",
      "Collecting pytz>=2017.2\n",
      "  Downloading pytz-2020.1-py2.py3-none-any.whl (510 kB)\n",
      "Requirement already satisfied: python-dateutil>=2.7.3 in c:\\users\\shuei\\miniconda3\\envs\\tfgpu\\lib\\site-packages (from pandas) (2.8.1)\n",
      "Requirement already satisfied: six>=1.5 in c:\\users\\shuei\\miniconda3\\envs\\tfgpu\\lib\\site-packages (from python-dateutil>=2.7.3->pandas) (1.15.0)\n",
      "Installing collected packages: pytz, pandas\n",
      "Successfully installed pandas-1.1.2 pytz-2020.1\n"
     ]
    }
   ],
   "source": [
    "!pip install pandas \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "300\n"
     ]
    }
   ],
   "source": [
    "\n",
    "pd.set_option('display.max_rows',300)\n",
    "print (pd.get_option(\"display.max_rows\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>imdb_title_id</th>\n",
       "      <th>ordering</th>\n",
       "      <th>imdb_name_id</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0846887</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Kate Kelly\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0846894</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"School Master\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>3</td>\n",
       "      <td>nm3002376</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Steve Hart\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0170118</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>5</td>\n",
       "      <td>nm0846879</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377843</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>5</td>\n",
       "      <td>nm10532693</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377844</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>6</td>\n",
       "      <td>nm10531260</td>\n",
       "      <td>producer</td>\n",
       "      <td>producer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377845</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>7</td>\n",
       "      <td>nm6044359</td>\n",
       "      <td>composer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377846</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>8</td>\n",
       "      <td>nm10532695</td>\n",
       "      <td>cinematographer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377847</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>9</td>\n",
       "      <td>nm9492020</td>\n",
       "      <td>editor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>377848 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       imdb_title_id  ordering imdb_name_id         category       job  \\\n",
       "0          tt0000574         1    nm0846887          actress       NaN   \n",
       "1          tt0000574         2    nm0846894            actor       NaN   \n",
       "2          tt0000574         3    nm3002376            actor       NaN   \n",
       "3          tt0000574         4    nm0170118          actress       NaN   \n",
       "4          tt0000574         5    nm0846879         director       NaN   \n",
       "...              ...       ...          ...              ...       ...   \n",
       "377843     tt9903716         5   nm10532693         director       NaN   \n",
       "377844     tt9903716         6   nm10531260         producer  producer   \n",
       "377845     tt9903716         7    nm6044359         composer       NaN   \n",
       "377846     tt9903716         8   nm10532695  cinematographer       NaN   \n",
       "377847     tt9903716         9    nm9492020           editor       NaN   \n",
       "\n",
       "               characters  \n",
       "0          [\"Kate Kelly\"]  \n",
       "1       [\"School Master\"]  \n",
       "2          [\"Steve Hart\"]  \n",
       "3                     NaN  \n",
       "4                     NaN  \n",
       "...                   ...  \n",
       "377843                NaN  \n",
       "377844                NaN  \n",
       "377845                NaN  \n",
       "377846                NaN  \n",
       "377847                NaN  \n",
       "\n",
       "[377848 rows x 6 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df = pd.read_csv(\"IMDb title_principals.csv\")\n",
    "TP_df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "imdb_title_id    False\n",
      "ordering         False\n",
      "imdb_name_id     False\n",
      "category         False\n",
      "job               True\n",
      "characters        True\n",
      "dtype: bool\n"
     ]
    }
   ],
   "source": [
    "print(TP_df.isnull().any())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0              NaN\n",
       "1              NaN\n",
       "2              NaN\n",
       "3              NaN\n",
       "4              NaN\n",
       "            ...   \n",
       "377843         NaN\n",
       "377844    producer\n",
       "377845         NaN\n",
       "377846         NaN\n",
       "377847         NaN\n",
       "Name: job, Length: 377848, dtype: object"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['job']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "imdb_title_id    377848\n",
       "ordering         377848\n",
       "imdb_name_id     377848\n",
       "category         377848\n",
       "job               96788\n",
       "characters       153784\n",
       "dtype: int64"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "       imdb_title_id  ordering imdb_name_id  category  \\\n",
      "5          tt0000574         6    nm0317210  producer   \n",
      "6          tt0000574         7    nm0425854  producer   \n",
      "7          tt0000574         8    nm0846911  producer   \n",
      "16         tt0002130         7    nm0019604    writer   \n",
      "24         tt0002461         5    nm0130633  director   \n",
      "...              ...       ...          ...       ...   \n",
      "377826     tt9896916         7    nm9526002  producer   \n",
      "377827     tt9896916         8    nm4775123  producer   \n",
      "377828     tt9896916         9    nm9672560  producer   \n",
      "377829     tt9896916        10   nm10530067  producer   \n",
      "377844     tt9903716         6   nm10531260  producer   \n",
      "\n",
      "                              job characters  \n",
      "5                        producer        NaN  \n",
      "6                        producer        NaN  \n",
      "7                        producer        NaN  \n",
      "16      poem \"La Divina Commedia\"        NaN  \n",
      "24                    co-director        NaN  \n",
      "...                           ...        ...  \n",
      "377826         executive producer        NaN  \n",
      "377827                   producer        NaN  \n",
      "377828                   producer        NaN  \n",
      "377829                   producer        NaN  \n",
      "377844                   producer        NaN  \n",
      "\n",
      "[96788 rows x 6 columns]\n"
     ]
    }
   ],
   "source": [
    "print(TP_df[TP_df[['job','category']].notnull().all(1)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "producer                                                                 44262\n",
       "screenplay                                                               11084\n",
       "written by                                                                4727\n",
       "director of photography                                                   4720\n",
       "story                                                                     4358\n",
       "                                                                         ...  \n",
       "novel: \"Lacrime impure\"                                                      1\n",
       "novel \"L'Homme Qui Rit\"                                                      1\n",
       "novel \"The Echoing Grove\"                                                    1\n",
       "story \"There Shall Be No Darkness\"                                           1\n",
       "magazine article \"I Was an American Spy\" and novel \"Manila Espionage\"        1\n",
       "Name: job, Length: 4549, dtype: int64"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['job'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "actor                  100495\n",
       "actress                 60074\n",
       "writer                  55867\n",
       "producer                45719\n",
       "director                40106\n",
       "composer                30350\n",
       "cinematographer         25026\n",
       "editor                  15290\n",
       "production_designer      4300\n",
       "self                      433\n",
       "archive_footage           185\n",
       "archive_sound               3\n",
       "Name: category, dtype: int64"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['category'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(nan, actor)                                                            100495\n",
      "(nan, actress)                                                           60074\n",
      "(producer, producer)                                                     44261\n",
      "(nan, director)                                                          39632\n",
      "(nan, composer)                                                          29991\n",
      "                                                                         ...  \n",
      "(play \"Tis Pity She's a Whore\", writer)                                      1\n",
      "(based on the \"Narkover\" characterisations of \"BEACHCOMBER\", writer)         1\n",
      "(comic books \"Melting Pot\", writer)                                          1\n",
      "(novel \"Initiation au meurtre\", writer)                                      1\n",
      "(novel \"The Vanished Corpse\", writer)                                        1\n",
      "Name: job_cate, Length: 4567, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "res = TP_df.groupby([\"job\",\"category\"]).count()\n",
    "TP_df[\"job_cate\"] = list(zip(TP_df.job,TP_df.category))\n",
    "res = TP_df[\"job_cate\"].value_counts()\n",
    "print(res)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>imdb_title_id</th>\n",
       "      <th>ordering</th>\n",
       "      <th>imdb_name_id</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0846887</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Kate Kelly\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0846894</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"School Master\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>3</td>\n",
       "      <td>nm3002376</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Steve Hart\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0170118</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>5</td>\n",
       "      <td>nm0846879</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377843</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>5</td>\n",
       "      <td>nm10532693</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377844</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>6</td>\n",
       "      <td>nm10531260</td>\n",
       "      <td>producer</td>\n",
       "      <td>producer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377845</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>7</td>\n",
       "      <td>nm6044359</td>\n",
       "      <td>composer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377846</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>8</td>\n",
       "      <td>nm10532695</td>\n",
       "      <td>cinematographer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377847</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>9</td>\n",
       "      <td>nm9492020</td>\n",
       "      <td>editor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>377848 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       imdb_title_id  ordering imdb_name_id         category       job  \\\n",
       "0          tt0000574         1    nm0846887          actress       NaN   \n",
       "1          tt0000574         2    nm0846894            actor       NaN   \n",
       "2          tt0000574         3    nm3002376            actor       NaN   \n",
       "3          tt0000574         4    nm0170118          actress       NaN   \n",
       "4          tt0000574         5    nm0846879         director       NaN   \n",
       "...              ...       ...          ...              ...       ...   \n",
       "377843     tt9903716         5   nm10532693         director       NaN   \n",
       "377844     tt9903716         6   nm10531260         producer  producer   \n",
       "377845     tt9903716         7    nm6044359         composer       NaN   \n",
       "377846     tt9903716         8   nm10532695  cinematographer       NaN   \n",
       "377847     tt9903716         9    nm9492020           editor       NaN   \n",
       "\n",
       "               characters  \n",
       "0          [\"Kate Kelly\"]  \n",
       "1       [\"School Master\"]  \n",
       "2          [\"Steve Hart\"]  \n",
       "3                     NaN  \n",
       "4                     NaN  \n",
       "...                   ...  \n",
       "377843                NaN  \n",
       "377844                NaN  \n",
       "377845                NaN  \n",
       "377846                NaN  \n",
       "377847                NaN  \n",
       "\n",
       "[377848 rows x 6 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df=TP_df.drop(columns=['job_cate'])\n",
    "TP_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\shuei\\miniconda3\\envs\\tfgpu\\lib\\site-packages\\pandas\\core\\frame.py:4322: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  downcast=downcast,\n"
     ]
    }
   ],
   "source": [
    "TP_df.loc[TP_df['category'] == 'actor'].fillna('performer',inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>imdb_title_id</th>\n",
       "      <th>ordering</th>\n",
       "      <th>imdb_name_id</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0846887</td>\n",
       "      <td>actress</td>\n",
       "      <td>performer</td>\n",
       "      <td>[\"Kate Kelly\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0846894</td>\n",
       "      <td>actor</td>\n",
       "      <td>performer</td>\n",
       "      <td>[\"School Master\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>3</td>\n",
       "      <td>nm3002376</td>\n",
       "      <td>actor</td>\n",
       "      <td>performer</td>\n",
       "      <td>[\"Steve Hart\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0170118</td>\n",
       "      <td>actress</td>\n",
       "      <td>performer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>5</td>\n",
       "      <td>nm0846879</td>\n",
       "      <td>director</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377843</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>5</td>\n",
       "      <td>nm10532693</td>\n",
       "      <td>director</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377844</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>6</td>\n",
       "      <td>nm10531260</td>\n",
       "      <td>producer</td>\n",
       "      <td>producer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377845</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>7</td>\n",
       "      <td>nm6044359</td>\n",
       "      <td>composer</td>\n",
       "      <td>composer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377846</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>8</td>\n",
       "      <td>nm10532695</td>\n",
       "      <td>cinematographer</td>\n",
       "      <td>supervision</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377847</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>9</td>\n",
       "      <td>nm9492020</td>\n",
       "      <td>editor</td>\n",
       "      <td>editor</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>377848 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       imdb_title_id  ordering imdb_name_id         category          job  \\\n",
       "0          tt0000574         1    nm0846887          actress    performer   \n",
       "1          tt0000574         2    nm0846894            actor    performer   \n",
       "2          tt0000574         3    nm3002376            actor    performer   \n",
       "3          tt0000574         4    nm0170118          actress    performer   \n",
       "4          tt0000574         5    nm0846879         director     director   \n",
       "...              ...       ...          ...              ...          ...   \n",
       "377843     tt9903716         5   nm10532693         director     director   \n",
       "377844     tt9903716         6   nm10531260         producer     producer   \n",
       "377845     tt9903716         7    nm6044359         composer     composer   \n",
       "377846     tt9903716         8   nm10532695  cinematographer  supervision   \n",
       "377847     tt9903716         9    nm9492020           editor       editor   \n",
       "\n",
       "               characters  \n",
       "0          [\"Kate Kelly\"]  \n",
       "1       [\"School Master\"]  \n",
       "2          [\"Steve Hart\"]  \n",
       "3                     NaN  \n",
       "4                     NaN  \n",
       "...                   ...  \n",
       "377843                NaN  \n",
       "377844                NaN  \n",
       "377845                NaN  \n",
       "377846                NaN  \n",
       "377847                NaN  \n",
       "\n",
       "[377848 rows x 6 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df.loc[TP_df['category'] == 'actor', 'job'] = 'performer'\n",
    "TP_df.loc[TP_df['category'] == 'actress', 'job'] = 'performer'\n",
    "TP_df.loc[TP_df['category'] == 'writer', 'job'] = 'written by'\n",
    "TP_df.loc[TP_df['category'] == 'producer', 'job'] = 'producer'\n",
    "TP_df.loc[TP_df['category'] == 'director', 'job'] = 'director'\n",
    "TP_df.loc[TP_df['category'] == 'composer', 'job'] = 'composer'\n",
    "TP_df.loc[TP_df['category'] == 'cinematographer', 'job'] = 'supervision'\n",
    "TP_df.loc[TP_df['category'] == 'editor', 'job'] = 'editor'\n",
    "TP_df.loc[TP_df['category'] == 'production_designer', 'job'] = 'editor'\n",
    "TP_df.loc[TP_df['category'] == 'self', 'job'] = 'unknounr'\n",
    "TP_df.loc[TP_df['category'] == 'archive_footage', 'job'] = 'technician'\n",
    "TP_df.loc[TP_df['category'] == 'archive_sound', 'job'] = 'technician'\n",
    "\n",
    "TP_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>imdb_title_id</th>\n",
       "      <th>ordering</th>\n",
       "      <th>imdb_name_id</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377843</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377844</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377845</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377846</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377847</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>377848 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       imdb_title_id  ordering imdb_name_id category  job characters\n",
       "0                NaN       NaN          NaN      NaN  NaN        NaN\n",
       "1                NaN       NaN          NaN      NaN  NaN        NaN\n",
       "2                NaN       NaN          NaN      NaN  NaN        NaN\n",
       "3                NaN       NaN          NaN      NaN  NaN        NaN\n",
       "4                NaN       NaN          NaN      NaN  NaN        NaN\n",
       "...              ...       ...          ...      ...  ...        ...\n",
       "377843           NaN       NaN          NaN      NaN  NaN        NaN\n",
       "377844           NaN       NaN          NaN      NaN  NaN        NaN\n",
       "377845           NaN       NaN          NaN      NaN  NaN        NaN\n",
       "377846           NaN       NaN          NaN      NaN  NaN        NaN\n",
       "377847           NaN       NaN          NaN      NaN  NaN        NaN\n",
       "\n",
       "[377848 rows x 6 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df.fillna({'job':'performer'}).where (TP_df['category'] == 'actor')\n",
    "TP_df.fillna({'job':'performer'}).where (TP_df['category'] == 'actress')\n",
    "TP_df.fillna({'job':'written by'}).where (TP_df['category'] == 'writer')\n",
    "TP_df.fillna({'job':'producer'}).where (TP_df['category'] == 'producer')\n",
    "TP_df.fillna({'job':'director'}).where (TP_df['category'] == 'director')\n",
    "TP_df.fillna({'job':'composer'}).where (TP_df['category'] == 'composer')\n",
    "TP_df.fillna({'job':'supervision'}).where (TP_df['category'] == 'cinematographer')\n",
    "TP_df.fillna({'job':'editor'}).where (TP_df['category'] == 'editor')\n",
    "TP_df.fillna({'job':'editor'}).where (TP_df['category'] == 'production_designer')\n",
    "TP_df.fillna({'job':'unnown'}).where (TP_df['category'] == 'self')\n",
    "TP_df.fillna({'job':'technician'}).where (TP_df['category'] == 'archive_footage')\n",
    "TP_df.fillna({'job':'technician'}).where (TP_df['category'] == 'archive_sound')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "imdb_title_id    False\n",
      "ordering         False\n",
      "imdb_name_id     False\n",
      "category         False\n",
      "job              False\n",
      "characters        True\n",
      "dtype: bool\n"
     ]
    }
   ],
   "source": [
    "print(TP_df.isnull().any())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>imdb_title_id</th>\n",
       "      <th>ordering</th>\n",
       "      <th>imdb_name_id</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0846887</td>\n",
       "      <td>actress</td>\n",
       "      <td>performer</td>\n",
       "      <td>[\"Kate Kelly\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0846894</td>\n",
       "      <td>actor</td>\n",
       "      <td>performer</td>\n",
       "      <td>[\"School Master\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>3</td>\n",
       "      <td>nm3002376</td>\n",
       "      <td>actor</td>\n",
       "      <td>performer</td>\n",
       "      <td>[\"Steve Hart\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0170118</td>\n",
       "      <td>actress</td>\n",
       "      <td>performer</td>\n",
       "      <td>NODATA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0000574</td>\n",
       "      <td>5</td>\n",
       "      <td>nm0846879</td>\n",
       "      <td>director</td>\n",
       "      <td>director</td>\n",
       "      <td>NODATA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377843</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>5</td>\n",
       "      <td>nm10532693</td>\n",
       "      <td>director</td>\n",
       "      <td>director</td>\n",
       "      <td>NODATA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377844</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>6</td>\n",
       "      <td>nm10531260</td>\n",
       "      <td>producer</td>\n",
       "      <td>producer</td>\n",
       "      <td>NODATA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377845</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>7</td>\n",
       "      <td>nm6044359</td>\n",
       "      <td>composer</td>\n",
       "      <td>composer</td>\n",
       "      <td>NODATA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377846</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>8</td>\n",
       "      <td>nm10532695</td>\n",
       "      <td>cinematographer</td>\n",
       "      <td>supervision</td>\n",
       "      <td>NODATA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>377847</th>\n",
       "      <td>tt9903716</td>\n",
       "      <td>9</td>\n",
       "      <td>nm9492020</td>\n",
       "      <td>editor</td>\n",
       "      <td>editor</td>\n",
       "      <td>NODATA</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>377848 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       imdb_title_id  ordering imdb_name_id         category          job  \\\n",
       "0          tt0000574         1    nm0846887          actress    performer   \n",
       "1          tt0000574         2    nm0846894            actor    performer   \n",
       "2          tt0000574         3    nm3002376            actor    performer   \n",
       "3          tt0000574         4    nm0170118          actress    performer   \n",
       "4          tt0000574         5    nm0846879         director     director   \n",
       "...              ...       ...          ...              ...          ...   \n",
       "377843     tt9903716         5   nm10532693         director     director   \n",
       "377844     tt9903716         6   nm10531260         producer     producer   \n",
       "377845     tt9903716         7    nm6044359         composer     composer   \n",
       "377846     tt9903716         8   nm10532695  cinematographer  supervision   \n",
       "377847     tt9903716         9    nm9492020           editor       editor   \n",
       "\n",
       "               characters  \n",
       "0          [\"Kate Kelly\"]  \n",
       "1       [\"School Master\"]  \n",
       "2          [\"Steve Hart\"]  \n",
       "3                  NODATA  \n",
       "4                  NODATA  \n",
       "...                   ...  \n",
       "377843             NODATA  \n",
       "377844             NODATA  \n",
       "377845             NODATA  \n",
       "377846             NODATA  \n",
       "377847             NODATA  \n",
       "\n",
       "[377848 rows x 6 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df.fillna({'characters':'NODATA'})\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "imdb_title_id    False\n",
      "ordering         False\n",
      "imdb_name_id     False\n",
      "category         False\n",
      "job              False\n",
      "characters        True\n",
      "dtype: bool\n"
     ]
    }
   ],
   "source": [
    "print(TP_df.isnull().any())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "performer      160569\n",
       "written by      55867\n",
       "producer        45719\n",
       "director        40106\n",
       "composer        30350\n",
       "supervision     25026\n",
       "editor          19590\n",
       "unknounr          433\n",
       "technician        188\n",
       "Name: job, dtype: int64"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['job'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib as plt \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "value_counts() got an unexpected keyword argument 'drop'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-26-52631c51ab6f>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mTP_df\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'job'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mvalue_counts\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdrop\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mplot\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mber\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m: value_counts() got an unexpected keyword argument 'drop'"
     ]
    }
   ],
   "source": [
    "TP_df['job'].value_counts(drop=False).plot.ber()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# from tensorflow.keras.callbacks import ModelCheckpoint\n",
    "import json\n",
    "#earlystopping_callback = EarlyStopping(monitor='accuracy')\n",
    "checkpoint = ModelCheckpoint('output/{accuracy:.4f}.hdf5',monitor='accuracy', save_best_only=True, mode='auto')\n",
    "classifier.fit_generator(training_set,epochs =100)\n",
    "# serialize model to JSON\n",
    "# lets assume `model` is main model \n",
    "model_json = classifier.to_json()\n",
    "with open(\"colors.json\", \"w\") as json_file:\n",
    "    json.dump(model_json, json_file)\n",
    "\n",
    "classifier.save_weights(\"colors.h5\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "value_counts() got an unexpected keyword argument 'drop'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-27-8be9dbc53e69>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mTP_df\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'job'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mvalue_counts\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdrop\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mto_frame\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mstyle\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mbar\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mvmin\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;36m0\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m: value_counts() got an unexpected keyword argument 'drop'"
     ]
    }
   ],
   "source": [
    "TP_df['job'].value_counts(drop=False).to_frame().style.bar(vmin=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method hist_series of 0           performer\n",
       "1           performer\n",
       "2           performer\n",
       "3           performer\n",
       "4            director\n",
       "             ...     \n",
       "377843       director\n",
       "377844       producer\n",
       "377845       composer\n",
       "377846    supervision\n",
       "377847         editor\n",
       "Name: job, Length: 377848, dtype: object>"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['job'].hist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method hist_series of 0                 actress\n",
       "1                   actor\n",
       "2                   actor\n",
       "3                 actress\n",
       "4                director\n",
       "               ...       \n",
       "377843           director\n",
       "377844           producer\n",
       "377845           composer\n",
       "377846    cinematographer\n",
       "377847             editor\n",
       "Name: category, Length: 377848, dtype: object>"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['category'].hist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method hist_series of 0            [\"Kate Kelly\"]\n",
       "1         [\"School Master\"]\n",
       "2            [\"Steve Hart\"]\n",
       "3                       NaN\n",
       "4                       NaN\n",
       "                ...        \n",
       "377843                  NaN\n",
       "377844                  NaN\n",
       "377845                  NaN\n",
       "377846                  NaN\n",
       "377847                  NaN\n",
       "Name: characters, Length: 377848, dtype: object>"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['characters'].hist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "prob1 = TP_df['job'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1080x216 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "TP_df['job'].value_counts().plot.bar(figsize=(15, 3), color='darkblue')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TP_df['characters'].value_counts().plot.bar(figsize=(15, 3), color='red')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "TP_df['category'].value_counts().plot.bar(figsize=(15, 3), color='darkblue')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
